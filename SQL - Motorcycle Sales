-- You're working for a company that sells motorcycle parts.

-- The board of directors want to gain a better understanding of wholesale revenue by product line, and how this varies month-to-month and across warehouses.
-- You have been tasked with calculating net revenue for each product line, grouping results by month and warehouse. The results should be filtered so that 
-- only "Wholesale" orders are included.


%%sql 
postgresql:///motorbikes


SELECT product_line, 
	CASE WHEN EXTRACT(month FROM date) = 6 THEN 'June'
        WHEN EXTRACT(month FROM date) = 7 THEN 'July'
        WHEN EXTRACT(month FROM date) = 8 THEN 'August'
        END AS month,
	warehouse, 
    ROUND(SUM(total * (1 - payment_fee))::numeric, 2) AS net_revenue
FROM sales
WHERE client_type = 'Wholesale'
GROUP BY product_line, warehouse, month 
ORDER BY product_line, month, net_revenue DESC;
